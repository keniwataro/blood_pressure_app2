<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="mb-4">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="h2">スタッフ詳細</h1>
        <% if current_user.administrator_at?(@hospital) %>
          <%= button_to "削除", medical_staff_staff_path(@staff_member), 
                        method: :delete,
                        class: "btn btn-outline-danger",
                        form: { data: { turbo_confirm: "#{@staff_member.name} を削除してもよろしいですか？\n\nこの操作は取り消せません。\n・スタッフの全ての情報が削除されます\n・担当患者との紐付けも解除されます" } } %>
        <% end %>
      </div>
    </div>

    <!-- スタッフ情報カード -->
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h4 class="mb-0">基本情報</h4>
        <% if current_user.administrator_at?(@hospital) %>
          <%= link_to "編集", edit_medical_staff_staff_path(@staff_member), class: "btn btn-warning btn-sm" %>
        <% end %>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="<%= current_user.administrator_at?(@hospital) ? 'col-md-6' : 'col-12' %>">
            <div class="mb-3">
              <strong class="text-muted">スタッフ名</strong>
              <p class="h5"><%= @staff_member.name %></p>
            </div>
          </div>
          <% if current_user.administrator_at?(@hospital) %>
            <div class="col-md-6">
              <div class="mb-3">
                <strong class="text-muted">ユーザーID</strong>
                <p class="h5 text-primary"><%= @staff_member.user_id %></p>
              </div>
            </div>
          <% end %>
        </div>
        <% if current_user.administrator_at?(@hospital) %>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <strong class="text-muted">メールアドレス</strong>
                <p><%= @staff_member.email %></p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <strong class="text-muted">登録日</strong>
                <p><%= @staff_member.created_at.strftime("%Y年%m月%d日") %></p>
              </div>
            </div>
          </div>
        <% end %>
        <hr>
        <div class="mb-3">
          <strong class="text-muted">役割</strong><br>
          <% @staff_roles.each do |uhr| %>
            <span class="badge bg-<%= case uhr.role.name
                                      when '医師' then 'primary'
                                      when '看護師' then 'success'
                                      when '医療事務' then 'info'
                                      else 'secondary'
                                      end %> fs-6 me-2">
              <%= uhr.role.name %>
            </span>
          <% end %>
        </div>
        <div class="mb-3">
          <strong class="text-muted">権限レベル</strong><br>
          <% @staff_roles.each do |uhr| %>
            <span class="badge bg-<%= uhr.permission_level_administrator? ? 'danger' : 'secondary' %> fs-6 me-2">
              <%= uhr.permission_level_administrator? ? '管理者' : '一般' %>
            </span>
          <% end %>
        </div>
        <div class="mb-3">
          <strong class="text-muted">所属病院</strong>
          <p><%= @hospital.name %></p>
        </div>
      </div>
    </div>

    <div class="mt-4">
      <%= link_to "← スタッフ一覧に戻る", medical_staff_staff_index_path, class: "btn btn-secondary" %>
    </div>
  </div>
</div>